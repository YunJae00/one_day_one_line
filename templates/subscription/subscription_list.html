{% extends 'common/base.html' %}
{% load static %}

{% block title %}구독 관리 - 하루 한 줄{% endblock %}

{% block extra_css %}
    <style>
        .subscription-page {
            padding: 4rem 0;
            background-color: #f6f8fd;
            min-height: calc(100vh - 350px);
        }

        .subscription-header {
            text-align: center;
            margin-bottom: 2.5rem;
        }

        .subscription-title {
            font-weight: 700;
            color: #2A3B47;
            margin-bottom: 0.5rem;
            position: relative;
            display: inline-block;
        }

        .subscription-title:after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 70px;
            height: 3px;
            background: linear-gradient(to right, #4288EE, #5b9afa);
            border-radius: 3px;
        }

        .subscription-subtitle {
            color: #6c757d;
            font-size: 1.1rem;
            margin-top: 1rem;
        }

        .subscription-card {
            border-radius: 1.25rem;
            overflow: hidden;
            border: none;
            box-shadow: 0 15px 35px rgba(66, 136, 238, 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            background: linear-gradient(to bottom, #ffffff, #f9fbff);
            margin-bottom: 2rem;
        }

        .subscription-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(66, 136, 238, 0.15);
        }

        .category-card {
            border-radius: 1rem;
            border: none;
            overflow: hidden;
            height: 100%;
            transition: all 0.3s ease;
            box-shadow: 0 8px 20px rgba(66, 136, 238, 0.08);
            background: linear-gradient(to bottom, #ffffff, #f9fbff);
        }

        .category-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 30px rgba(66, 136, 238, 0.12);
        }

        .category-card .card-title {
            font-weight: 600;
            color: #2A3B47;
            font-size: 1.25rem;
        }

        .category-card .card-text {
            color: #6c757d;
            font-size: 0.95rem;
            line-height: 1.6;
        }

        .card-header {
            background: transparent;
            border-bottom: none;
            padding: 1.5rem;
            position: relative;
        }

        .card-header h5 {
            font-weight: 700;
            color: #2A3B47;
            margin: 0;
            position: relative;
            display: inline-block;
        }

        .card-header h5:after {
            content: '';
            position: absolute;
            bottom: -5px;
            left: 0;
            width: 40px;
            height: 2px;
            background: linear-gradient(to right, #4288EE, #5b9afa);
            border-radius: 3px;
        }

        .card-body {
            padding: 1.5rem;
        }

        .card-footer {
            background-color: white;
            border-top: none;
            padding: 1.25rem 1.5rem;
        }

        .table-custom {
            margin-bottom: 0;
        }

        .table-custom th {
            font-weight: 600;
            color: #495057;
            border-top: none;
            border-bottom: 2px solid #e9ecef;
            padding: 1.2rem 1.5rem;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .table-custom td {
            vertical-align: middle;
            padding: 1.2rem 1.5rem;
            border-bottom: 1px solid #f0f0f0;
            color: #2A3B47;
            transition: all 0.2s ease;
            text-align: left;
        }

        .table-custom tr:last-child td {
            border-bottom: none;
        }

        .table-custom tr {
            transition: all 0.3s ease;
        }

        .table-custom tr:hover {
            background-color: rgba(66, 136, 238, 0.05);
            box-shadow: inset 4px 0 0 #4288EE;
        }

        .badge {
            padding: 0.6rem 1rem;
            border-radius: 0.75rem;
            font-weight: 500;
            font-size: 0.9rem;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.08);
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }

        .badge-success {
            background: linear-gradient(135deg, #28a745, #5cc375);
            color: white;
        }

        .badge-warning {
            background: linear-gradient(135deg, #ffc107, #ffdb6d);
            color: #212529;
        }

        .badge-secondary {
            background: linear-gradient(135deg, #6c757d, #9aa0a6);
            color: white;
        }

        .active-buttons .btn {
            padding: 0.6rem 1.2rem;
            border-radius: 0.75rem;
            font-weight: 500;
            transition: all 0.3s ease;
            white-space: nowrap;
        }

        .btn-sm {
            padding: 0.4rem 0.8rem;
            font-size: 0.875rem;
        }

        .btn-lg {
            padding: 0.8rem 1.8rem;
            font-size: 1.1rem;
        }

        .btn-primary {
            background: linear-gradient(135deg, #4288EE, #5b9afa);
            border: none;
            color: white;
        }

        .btn-primary:hover {
            background: linear-gradient(135deg, #3070d9, #4288EE);
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(66, 136, 238, 0.3);
        }

        .btn-group .btn {
            margin-left: 0.25rem;
        }

        .btn-outline-primary {
            color: #4288EE;
            border: 1px solid #4288EE;
            background-color: transparent;
        }

        .btn-outline-primary:hover {
            background-color: #4288EE;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(66, 136, 238, 0.3);
        }

        .btn-outline-secondary {
            color: #6c757d;
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
        }

        .btn-outline-secondary:hover {
            background-color: #e9ecef;
            color: #495057;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(108, 117, 125, 0.15);
        }

        .btn-outline-warning {
            color: #ffc107;
            border: 1px solid #ffc107;
            background-color: transparent;
        }

        .btn-outline-warning:hover {
            background-color: #ffc107;
            color: #212529;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(255, 193, 7, 0.3);
        }

        .btn-outline-success {
            color: #28a745;
            border: 1px solid #28a745;
            background-color: transparent;
        }

        .btn-outline-success:hover {
            background-color: #28a745;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(40, 167, 69, 0.3);
        }

        .btn-outline-danger {
            color: #dc3545;
            border: 1px solid #dc3545;
            background-color: transparent;
        }

        .btn-outline-danger:hover {
            background-color: #dc3545;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(220, 53, 69, 0.3);
        }

        .empty-state {
            text-align: center;
            padding: 4rem 2rem;
        }

        .empty-state-icon {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: linear-gradient(135deg, #f0f5ff, #e6eeff);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 1.5rem;
            position: relative;
            animation: pulse 2s infinite;
        }

        .empty-state-icon svg {
            color: #4288EE;
            width: 60px;
            height: 60px;
        }

        .empty-state-title {
            font-weight: 600;
            color: #2A3B47;
            margin-bottom: 1rem;
            font-size: 1.5rem;
        }

        .empty-state-subtitle {
            color: #6c757d;
            margin-bottom: 2rem;
            font-size: 1.1rem;
            max-width: 500px;
            margin-left: auto;
            margin-right: auto;
        }

        .category-icon {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: linear-gradient(135deg, #f0f5ff, #e6eeff);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 1.2rem;
            transition: all 0.3s ease;
        }

        .category-icon svg {
            color: #4288EE;
            transition: all 0.3s ease;
        }

        .category-card:hover .category-icon {
            transform: scale(1.1);
            box-shadow: 0 10px 20px rgba(66, 136, 238, 0.15);
        }

        .benefit-icon {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: linear-gradient(135deg, #f0f5ff, #e6eeff);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 1.2rem;
            transition: all 0.3s ease;
        }

        .benefit-icon svg {
            color: #4288EE;
            transition: all 0.3s ease;
        }

        .faq-item {
            padding: 1.2rem;
            border-radius: 1rem;
            margin-bottom: 1rem;
            transition: all 0.3s ease;
            border: 1px solid #f0f0f0;
        }

        .faq-item:hover {
            background-color: #f8f9fa;
            transform: translateX(5px);
            border-color: #e9ecef;
        }

        .faq-question {
            font-weight: 600;
            color: #2A3B47;
            margin-bottom: 0.7rem;
            display: flex;
            align-items: center;
        }

        .faq-question:before {
            content: 'Q';
            display: inline-block;
            width: 24px;
            height: 24px;
            background: linear-gradient(135deg, #4288EE, #5b9afa);
            color: white;
            border-radius: 50%;
            text-align: center;
            line-height: 24px;
            margin-right: 0.75rem;
            font-size: 0.85rem;
            font-weight: 700;
        }

        .faq-answer {
            color: #6c757d;
            margin-left: 2.5rem;
            position: relative;
        }

        .faq-answer:before {
            content: 'A';
            position: absolute;
            left: -2.5rem;
            display: inline-block;
            width: 24px;
            height: 24px;
            background: linear-gradient(135deg, #e9ecef, #f8f9fa);
            color: #6c757d;
            border-radius: 50%;
            text-align: center;
            line-height: 24px;
            font-size: 0.85rem;
            font-weight: 700;
        }

        .dropdown-icon {
            margin-left: 5px;
            color: #4288EE;
            transition: transform 0.3s ease;
        }

        /* 카테고리 드롭다운 스타일 */
        .category-wrapper {
            display: flex;
            align-items: center;
            text-align: left;
            justify-content: flex-start;
        }

        @keyframes pulse {
            0% {
                box-shadow: 0 0 0 0 rgba(66, 136, 238, 0.2);
            }
            70% {
                box-shadow: 0 0 0 10px rgba(66, 136, 238, 0);
            }
            100% {
                box-shadow: 0 0 0 0 rgba(66, 136, 238, 0);
            }
        }

        /* 카테고리 왼쪽 정렬 */
        .table-custom td:first-child .mobile-content {
            justify-content: flex-start !important;
            padding-left: 0;
            text-align: left !important;
        }

        /* 모든 데이터 셀에 대한 공통 스타일 적용 */
        .table-custom td .mobile-content {
            width: 100%;
            flex: 1;
            display: flex !important;
            justify-content: flex-start !important;
            text-align: left !important;
            padding-left: 0 !important;
        }

        /* 상태, 수신주기, 수신시간, 시작일 정보 레이아웃 - 모두 왼쪽 정렬로 통일 */
        .table-custom td:nth-child(2) .mobile-content,
        .table-custom td:nth-child(3) .mobile-content,
        .table-custom td:nth-child(4) .mobile-content,
        .table-custom td:nth-child(5) .mobile-content {
            justify-content: flex-start !important;
            padding-left: 0 !important;
            text-align: left !important;
        }

        /* 라벨 너비 조정 */
        .mobile-label {
            min-width: 80px;
            text-align: left !important;
            margin-right: 10px;
        }

        /* 모바일 화면 개선 */
        @media (max-width: 767.98px) {
            .subscription-page {
                padding: 2rem 0;
            }

            .subscription-header {
                margin-bottom: 1.5rem;
            }

            .subscription-title {
                font-size: 1.5rem;
            }

            .subscription-subtitle {
                font-size: 1rem;
            }

            .card-header, .card-body, .card-footer {
                padding: 1rem;
            }

            /* 테이블 개선 */
            .table-custom th,
            .table-custom td {
                padding: 0.75rem 1rem !important;
                font-size: 0.9rem;
                text-align: left !important;
            }

            /* 버튼 그룹 개선 */
            .active-buttons {
                display: flex;
                flex-wrap: wrap;
                gap: 8px; /* 버튼 사이 간격 증가 */
                justify-content: flex-start; /* 왼쪽 정렬로 변경 */
                margin-top: 10px; /* 위쪽 여백 추가 */
            }

            .active-buttons .btn-group {
                display: inline-flex;
                flex-wrap: wrap;
                gap: 0.5rem;
                margin-left: 0;
            }

            .active-buttons .btn {
                margin: 0 !important;
                flex: 0 0 auto;
                margin-bottom: 5px; /* 버튼 아래 여백 추가 */
            }

            /* 컬럼 레이아웃 조정 - 가로 스크롤보다 접을 수 있는 레이아웃 */
            .table-custom {
                width: 100%;
            }

            /* 행 높이 조정 */
            .table-custom tr {
                height: auto;
                display: flex;
                flex-direction: column;
                padding: 12px 0; /* 패딩 증가 */
                border-bottom: 1px solid #f0f0f0;
                margin-bottom: 5px; /* 행 간격 추가 */
            }

            .table-custom tr:last-child {
                border-bottom: none;
            }

            .table-custom td,
            .table-custom th {
                display: flex;
                width: 100%;
                border: none;
                padding: 0.5rem 1rem;
                text-align: left !important;
            }

            /* 특정 데이터에 라벨 추가 */
            .mobile-label {
                display: none;
                font-weight: 600;
                width: 40%;
                color: #495057;
                margin-right: 10px;
                min-width: 80px; /* 최소 너비 지정 */
                text-align: left !important;
            }

            .table-custom td .mobile-content {
                width: 60%;
                flex: 1;
                display: flex !important;
                justify-content: flex-start !important;
                text-align: left !important;
            }

            /* 헤더 숨기기 */
            .table-custom thead {
                display: none;
            }

            /* 활성화 버튼 정렬 */
            .table-custom td:last-child {
                margin-top: 0.5rem;
            }

            /* 수신 주기 레이아웃 수정 */
            .table-custom td:nth-child(3) {
                display: flex;
                align-items: center;
            }

            /* 주기 텍스트가 세로로 표시되는 문제 수정 */
            .table-custom td:nth-child(3) .mobile-content {
                white-space: nowrap;
                overflow: hidden;
                text-overflow: ellipsis;
                justify-content: flex-start !important;
            }

            /* 카테고리 텍스트 한 줄 표시 */
            .table-custom td:first-child .mobile-content span {
                white-space: nowrap;
                overflow: hidden;
                text-overflow: ellipsis;
                max-width: 200px; /* 최대 너비 설정 */
                display: inline-block;
            }

            /* 상태 표시 왼쪽 정렬 */
            .table-custom td:nth-child(2) {
                text-align: left !important;
            }

            .table-custom td:nth-child(2) .mobile-content {
                justify-content: flex-start !important; /* 왼쪽 정렬 강제 */
                text-align: left !important;
            }

            /* 모바일에서 아이콘과 텍스트 간격 */
            .table-custom svg.me-2 {
                margin-right: 8px !important;
            }

            /* 수정/일시정지/구독취소 버튼 레이아웃 */
            td:last-child .active-buttons {
                flex-direction: row;
                align-items: center;
                justify-content: flex-start;
                margin-left: 0;
            }

            .empty-state {
                padding: 2.5rem 1rem;
            }

            .empty-state-icon {
                width: 90px;
                height: 90px;
            }

            .empty-state-icon svg {
                width: 45px;
                height: 45px;
            }

            .empty-state-title {
                font-size: 1.3rem;
            }

            .empty-state-subtitle {
                font-size: 1rem;
            }

            /* 혜택 섹션 조정 */
            .benefit-icon {
                width: 70px;
                height: 70px;
                margin-bottom: 1rem;
            }

            .benefit-icon svg {
                width: 32px;
                height: 32px;
            }

            /* 모바일 레이블과 콘텐츠 레이아웃 조정 */
            .table-custom td > div.d-flex {
                width: 100%;
                justify-content: flex-start !important;
            }
        }

        @media (max-width: 575.98px) {
            .subscription-page {
                padding: 1.5rem 0;
            }

            .subscription-card {
                margin: 0 0.5rem 1rem;
                border-radius: 1rem;
            }

            .subscription-title {
                font-size: 1.3rem;
            }

            .subscription-subtitle {
                font-size: 0.9rem;
                margin-top: 0.75rem;
            }

            .card-header h5 {
                font-size: 1.1rem;
            }

            /* 더 작은 화면에서의 추가 조정 */
            .table-custom td:first-child .mobile-content span {
                max-width: 150px; /* 더 작은 화면에서는 더 짧게 */
            }

            /* 버튼 크기 조정 */
            .active-buttons .btn {
                padding: 6px 10px;
                font-size: 0.8rem;
            }

            .active-buttons .btn svg {
                width: 12px;
                height: 12px;
            }

            /* 버튼 그룹 정렬 */
            td:last-child .active-buttons {
                justify-content: flex-start;
                margin-left: 0;
            }

            /* FAQ 섹션 조정 */
            .faq-item {
                padding: 1rem;
            }

            .faq-question {
                font-size: 0.95rem;
            }

            .faq-answer {
                font-size: 0.85rem;
                margin-left: 2rem;
            }

            .faq-question:before,
            .faq-answer:before {
                width: 20px;
                height: 20px;
                line-height: 20px;
                font-size: 0.8rem;
            }

            .faq-answer:before {
                left: -2rem;
            }

            /* 모든 아이콘 크기 조정 */
            svg {
                vertical-align: middle;
            }
        }

        @media (min-width: 768px) {
            .mobile-label {
                display: none !important;
            }

            /* PC 화면에서도 모든 셀 왼쪽 정렬 유지 */
            .table-custom td,
            .table-custom th {
                text-align: left !important;
            }

            /* PC 화면에서도 mobile-content 왼쪽 정렬 유지 */
            .table-custom td .mobile-content {
                justify-content: flex-start !important;
                text-align: left !important;
                padding-left: 0 !important;
            }
        }
    </style>
{% endblock %}

{% block content %}
    <section class="subscription-page">
        <div class="container">
            <div class="subscription-header">
                <h1 class="subscription-title">구독 관리</h1>
                <p class="subscription-subtitle">구독 중인 카테고리 및 설정을 관리할 수 있습니다.</p>
            </div>

            {% if subscriptions %}
                <div class="subscription-card">
                    <div class="active-buttons card-header d-flex justify-content-between align-items-center">
                        <h5>구독 중인 카테고리</h5>
                        <a href="{% url 'subscription:subscribe' %}" class="btn btn-primary btn-sm">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                                 class="bi bi-plus-lg me-1" viewBox="0 0 16 16">
                                <path fill-rule="evenodd"
                                      d="M8 2a.5.5 0 0 1 .5.5v5h5a.5.5 0 0 1 0 1h-5v5a.5.5 0 0 1-1 0v-5h-5a.5.5 0 0 1 0-1h5v-5A.5.5 0 0 1 8 2Z"/>
                            </svg>
                            새 구독
                        </a>
                    </div>
                    <div class="table-responsive">
                        <table class="table table-custom">
                            <thead>
                            <tr>
                                <th>카테고리</th>
                                <th>상태</th>
                                <th class="d-none d-md-table-cell">수신 주기</th>
                                <th class="d-none d-md-table-cell">수신 시간</th>
                                <th class="d-none d-md-table-cell">시작일</th>
                                <th class="text-end">관리</th>
                            </tr>
                            </thead>
                            <tbody>
                            {% for subscription in subscriptions %}
                                {% if subscription.status != 'cancelled' %}
                                    <tr>
                                        <!-- 수정된 테이블 셀 구조 -->
                                        <td>
                                            <div class="d-flex align-items-center">
                                                <span class="mobile-label">카테고리</span>
                                                <div class="mobile-content d-flex align-items-center">
                                                    <div class="category-wrapper">
                                                        <span class="category-name">{{ subscription.category.name }}</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </td>
                                        <td>
                                            <span class="mobile-label">상태</span>
                                            <div class="mobile-content d-flex align-items-center">
                                                {% if subscription.status == 'active' %}
                                                    <span class="badge badge-success">활성</span>
                                                {% elif subscription.status == 'paused' %}
                                                    <span class="badge badge-warning">일시정지</span>
                                                {% endif %}
                                            </div>
                                        </td>
                                        <td>
                                            <span class="mobile-label">수신 주기</span>
                                            <div class="mobile-content">{{ subscription.get_frequency_display }}</div>
                                        </td>
                                        <td>
                                            <span class="mobile-label">수신 시간</span>
                                            <div class="mobile-content">{{ subscription.preferred_time|time:"H:i" }}</div>
                                        </td>
                                        <td>
                                            <span class="mobile-label">시작일</span>
                                            <div class="mobile-content">{{ subscription.start_date|date:"Y.m.d" }}</div>
                                        </td>
                                        <td>
                                            <div class="active-buttons">
                                                <a href="{% url 'subscription:manage' subscription.id %}"
                                                   class="btn btn-sm btn-outline-secondary">
                                                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14"
                                                         fill="currentColor"
                                                         class="bi bi-gear me-1"
                                                         viewBox="0 0 16 16">
                                                        <path d="M8 4.754a3.246 3.246 0 1 0 0 6.492 3.246 3.246 0 0 0 0-6.492zM5.754 8a2.246 2.246 0 1 1 4.492 0 2.246 2.246 0 0 1-4.492 0z"/>
                                                        <path d="M9.796 1.343c-.527-1.79-3.065-1.79-3.592 0l-.094.319a.873.873 0 0 1-1.255.52l-.292-.16c-1.64-.892-3.433.902-2.54 2.541l.159.292a.873.873 0 0 1-.52 1.255l-.319.094c-1.79.527-1.79 3.065 0 3.592l.319.094a.873.873 0 0 1 .52 1.255l-.16.292c-.892 1.64.901 3.434 2.541 2.54l.292-.159a.873.873 0 0 1 1.255.52l.094.319c.527 1.79 3.065 1.79 3.592 0l.094-.319a.873.873 0 0 1 1.255-.52l.292.16c1.64.893 3.434-.902 2.54-2.541l-.159-.292a.873.873 0 0 1 .52-1.255l.319-.094c1.79-.527 1.79-3.065 0-3.592l-.319-.094a.873.873 0 0 1-.52-1.255l.16-.292c.893-1.64-.902-3.433-2.541-2.54l-.292.159a.873.873 0 0 1-1.255-.52l-.094-.319zm-2.633.283c.246-.835 1.428-.835 1.674 0l.094.319a1.873 1.873 0 0 0 2.693 1.115l.291-.16c.764-.415 1.6.42 1.184 1.185l-.159.292a1.873 1.873 0 0 0 1.116 2.692l.318.094c.835.246.835 1.428 0 1.674l-.319.094a1.873 1.873 0 0 0-1.115 2.693l.16.291c.415.764-.42 1.6-1.185 1.184l-.291-.159a1.873 1.873 0 0 0-2.693 1.116l-.094.318c-.246.835-1.428.835-1.674 0l-.094-.319a1.873 1.873 0 0 0-2.692-1.115l-.292.16c-.764.415-1.6-.42-1.184-1.185l.159-.291A1.873 1.873 0 0 0 1.945 8.93l-.319-.094c-.835-.246-.835-1.428 0-1.674l.319-.094A1.873 1.873 0 0 0 3.06 4.377l-.16-.292c-.415-.764.42-1.6 1.185-1.184l.292.159a1.873 1.873 0 0 0 2.692-1.115l.094-.319z"/>
                                                    </svg>
                                                    수정
                                                </a>
                                                {% if subscription.status == 'active' %}
                                                    <a href="{% url 'subscription:pause' subscription.id %}"
                                                       class="btn btn-sm btn-outline-warning">
                                                        <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14"
                                                             fill="currentColor"
                                                             class="bi bi-pause-fill me-1"
                                                             viewBox="0 0 16 16">
                                                            <path d="M5.5 3.5A1.5 1.5 0 0 1 7 5v6a1.5 1.5 0 0 1-3 0V5a1.5 1.5 0 0 1 1.5-1.5zm5 0A1.5 1.5 0 0 1 12 5v6a1.5 1.5 0 0 1-3 0V5a1.5 1.5 0 0 1 1.5-1.5z"/>
                                                        </svg>
                                                        일시정지
                                                    </a>
                                                {% elif subscription.status == 'paused' %}
                                                    <a href="{% url 'subscription:activate' subscription.id %}"
                                                       class="btn btn-sm btn-outline-success">
                                                        <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14"
                                                             fill="currentColor"
                                                             class="bi bi-play-fill me-1"
                                                             viewBox="0 0 16 16">
                                                            <path d="m11.596 8.697-6.363 3.692c-.54.313-1.233-.066-1.233-.697V4.308c0-.63.692-1.01 1.233-.696l6.363 3.692a.802.802 0 0 1 0 1.393z"/>
                                                        </svg>
                                                        활성화
                                                    </a>
                                                {% endif %}
                                                <a href="{% url 'subscription:cancel' subscription.id %}"
                                                   class="btn btn-sm btn-outline-danger">
                                                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14"
                                                         fill="currentColor"
                                                         class="bi bi-x-lg me-1"
                                                         viewBox="0 0 16 16">
                                                        <path d="M2.146 2.854a.5.5 0 1 1 .708-.708L8 7.293l5.146-5.147a.5.5 0 0 1 .708.708L8.707 8l5.147 5.146a.5.5 0 0 1-.708.708L8 8.707l-5.146 5.147a.5.5 0 0 1-.708-.708L7.293 8 2.146 2.854Z"/>
                                                    </svg>
                                                    구독취소
                                                </a>
                                            </div>
                                        </td>
                                    </tr>
                                {% endif %}
                            {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            {% else %}
                <!-- 구독이 없는 경우 표시할 내용 -->
                <div class="subscription-card">
                    <div class="empty-state">
                        <div class="empty-state-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="60" height="60" fill="currentColor"
                                 class="bi bi-envelope-plus" viewBox="0 0 16 16">
                                <path d="M2 2a2 2 0 0 0-2 2v8.01A2 2 0 0 0 2 14h5.5a.5.5 0 0 0 0-1H2a1 1 0 0 1-.966-.741l5.64-3.471L8 9.583l7-4.2V8.5a.5.5 0 0 0 1 0V4a2 2 0 0 0-2-2H2Zm3.708 6.208L1 11.105V5.383l4.708 2.825ZM1 4.217V4a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v.217l-7 4.2-7-4.2Z"/>
                                <path d="M16 12.5a3.5 3.5 0 1 1-7 0 3.5 3.5 0 0 1 7 0Zm-3.5-2a.5.5 0 0 0-.5.5v1h-1a.5.5 0 0 0 0 1h1v1a.5.5 0 0 0 1 0v-1h1a.5.5 0 0 0 0-1h-1v-1a.5.5 0 0 0-.5-.5Z"/>
                            </svg>
                        </div>
                        <h3 class="empty-state-title">아직 구독 중인 카테고리가 없습니다</h3>
                        <p class="empty-state-subtitle">
                            매일 이메일로 유용한 지식을 받아보세요. 원하는 주제를 선택하여 꾸준한 성장을 시작해보세요.
                        </p>
                        <a href="{% url 'subscription:subscribe' %}" class="btn btn-primary">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                                 class="bi bi-plus-lg me-1" viewBox="0 0 16 16">
                                <path fill-rule="evenodd"
                                      d="M8 2a.5.5 0 0 1 .5.5v5h5a.5.5 0 0 1 0 1h-5v5a.5.5 0 0 1-1 0v-5h-5a.5.5 0 0 1 0-1h5v-5A.5.5 0 0 1 8 2Z"/>
                            </svg>
                            새로운 구독 시작하기
                        </a>
                    </div>
                </div>
            {% endif %}

            <!-- 구독 혜택 안내 섹션 -->
            <div class="subscription-card">
                <div class="card-header">
                    <h5>구독 혜택</h5>
                </div>
                <div class="card-body">
                    <div class="row align-items-center">
                        <div class="col-md-4 mb-4 mb-md-0 text-center">
                            <div class="benefit-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" width="36" height="36" fill="currentColor"
                                     class="bi bi-lightning-charge" viewBox="0 0 16 16">
                                    <path d="M11.251.068a.5.5 0 0 1 .227.58L9.677 6.5H13a.5.5 0 0 1 .364.843l-8 8.5a.5.5 0 0 1-.842-.49L6.323 9.5H3a.5.5 0 0 1-.364-.843l8-8.5a.5.5 0 0 1 .615-.09zM4.157 8.5H7a.5.5 0 0 1 .478.647L6.11 13.59l5.732-6.09H9a.5.5 0 0 1-.478-.647L9.89 2.41 4.157 8.5z"/>
                                </svg>
                            </div>
                            <h5>빠른 지식 습득</h5>
                            <p class="text-muted">1분만에 읽고 5분만에 이해하는 최적화된, 꼭 필요한 지식을 제공합니다.</p>
                        </div>
                        <div class="col-md-4 mb-4 mb-md-0 text-center">
                            <div class="benefit-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" width="36" height="36" fill="currentColor"
                                     class="bi bi-calendar-check" viewBox="0 0 16 16">
                                    <path d="M10.854 7.146a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 1 1 .708-.708L7.5 9.793l2.646-2.647a.5.5 0 0 1 .708 0z"/>
                                    <path d="M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5zM1 4v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V4H1z"/>
                                </svg>
                            </div>
                            <h5>꾸준한 학습 습관</h5>
                            <p class="text-muted">매일 정해진 시간에 이메일로 받아보는 지식으로 꾸준한 학습 습관을 만들어보세요.</p>
                        </div>
                        <div class="col-md-4 text-center">
                            <div class="benefit-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" width="36" height="36" fill="currentColor"
                                     class="bi bi-graph-up-arrow" viewBox="0 0 16 16">
                                    <path fill-rule="evenodd"
                                          d="M0 0h1v15h15v1H0V0Zm10 3.5a.5.5 0 0 1 .5-.5h4a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-1 0V4.9l-3.613 4.417a.5.5 0 0 1-.74.037L7.06 6.767l-3.656 5.027a.5.5 0 0 1-.808-.588l4-5.5a.5.5 0 0 1 .758-.06l2.609 2.61L13.445 4H10.5a.5.5 0 0 1-.5-.5Z"/>
                                </svg>
                            </div>
                            <h5>개인 성장 트래킹</h5>
                            <p class="text-muted">읽은 메일과 학습한 주제들을 확인하고 자신의 지식 성장을 확인할 수 있습니다.</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 자주 묻는 질문 섹션 -->
            <div class="subscription-card">
                <div class="card-header">
                    <h5>자주 묻는 질문</h5>
                </div>
                <div class="card-body">
                    <div class="faq-item">
                        <h6 class="faq-question">여러 카테고리를 한 번에 구독할 수 있나요?</h6>
                        <p class="faq-answer">네, 원하시는 만큼 여러 카테고리를 동시에 구독하실 수 있습니다. 각 카테고리별로 구독 설정을 다르게 지정할 수도 있습니다.</p>
                    </div>
                    <div class="faq-item">
                        <h6 class="faq-question">언제든지 구독을 취소할 수 있나요?</h6>
                        <p class="faq-answer">물론입니다. 원하실 때 언제든지 구독을 취소하거나 일시 정지하실 수 있습니다.</p>
                    </div>
                    <div class="faq-item">
                        <h6 class="faq-question">이메일 수신 시간을 변경할 수 있나요?</h6>
                        <p class="faq-answer">네, 구독 관리 페이지에서 각 카테고리별로 원하시는 수신 시간을 설정하실 수 있습니다.</p>
                    </div>
                    <div class="faq-item">
                        <h6 class="faq-question">당일 구독 설정 시 이메일 발송 시간에 제한이 있나요?</h6>
                        <p class="faq-answer">네, 당일 발송을 원하시면 발송 시간으로부터 최소 10분 이전에 구독 설정을 완료해야 합니다. 예를 들어, 오후 3시에 메일을 받고
                            싶으시다면 오후 2시 50분 이전에 구독 설정을 완료해야 합니다. 발송 시간 10분 전 이후에 설정하시면 해당 날짜에는 메일이 발송되지 않습니다.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>
{% endblock %}

{% block extra_js %}
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // 모바일 환경 감지
            function isMobile() {
                return window.innerWidth <= 767.98;
            }

            // 모든 셀 콘텐츠 왼쪽 정렬 강제 적용
            function forceLeftAlignment() {
                // 모든 셀의 콘텐츠를 왼쪽 정렬
                const allMobileContents = document.querySelectorAll('.mobile-content');
                allMobileContents.forEach(content => {
                    content.style.justifyContent = 'flex-start';
                    content.style.textAlign = 'left';
                    content.style.paddingLeft = '0';
                });

                // 모든 행에 있는 div 요소들 왼쪽 정렬
                const rowDivs = document.querySelectorAll('.table-custom td > div');
                rowDivs.forEach(div => {
                    div.style.justifyContent = 'flex-start';
                    div.style.textAlign = 'left';
                });

                // 상태, 수신주기, 수신시간, 시작일 정보 레이아웃 - 왼쪽 정렬 강제
                const statusCells = document.querySelectorAll('.table-custom td:nth-child(2) .mobile-content, .table-custom td:nth-child(3) .mobile-content, .table-custom td:nth-child(4) .mobile-content, .table-custom td:nth-child(5) .mobile-content');
                statusCells.forEach(cell => {
                    cell.style.justifyContent = 'flex-start';
                    cell.style.textAlign = 'left';
                    cell.style.paddingLeft = '0';
                });
            }

            // 모바일 레이블 표시/숨김 처리
            function handleMobileLabels() {
                const mobileLabels = document.querySelectorAll('.mobile-label');

                // 먼저 강제 왼쪽 정렬 적용
                forceLeftAlignment();

                if (isMobile()) {
                    mobileLabels.forEach(label => {
                        label.style.display = 'block';
                        label.style.textAlign = 'left';
                    });

                    // 카테고리명 처리
                    const categoryNames = document.querySelectorAll('.category-name');
                    categoryNames.forEach(name => {
                        name.style.whiteSpace = 'nowrap';
                        name.style.overflow = 'hidden';
                        name.style.textOverflow = 'ellipsis';
                        name.style.maxWidth = window.innerWidth <= 575.98 ? '150px' : '200px';
                        name.style.display = 'inline-block';
                    });

                    // 행 간격 조정
                    const tableRows = document.querySelectorAll('.table-custom tr');
                    tableRows.forEach(row => {
                        row.style.padding = '12px 0';
                        row.style.marginBottom = '8px';
                    });

                    // 버튼 그룹 간격 조정
                    const btnGroups = document.querySelectorAll('.active-buttons');
                    btnGroups.forEach(group => {
                        group.style.gap = '8px';
                        group.style.marginTop = '10px';
                        group.style.justifyContent = 'flex-start';
                    });
                } else {
                    // PC 화면에서도 모든 콘텐츠 왼쪽 정렬 유지
                    forceLeftAlignment();

                    // PC 화면에서는 mobile-label 확실히 숨기기
                    mobileLabels.forEach(label => {
                        label.style.display = 'none';
                    });
                }
            }

            // 초기 실행
            handleMobileLabels();

            // 화면 크기 변경 시 재실행
            window.addEventListener('resize', function() {
                handleMobileLabels();
            });

            // 페이지 로드 후 1초 후에 한 번 더 실행 (일부 브라우저에서 스타일이 늦게 적용되는 문제 해결)
            setTimeout(function() {
                forceLeftAlignment();
            }, 1000);
        });
    </script>
{% endblock %}